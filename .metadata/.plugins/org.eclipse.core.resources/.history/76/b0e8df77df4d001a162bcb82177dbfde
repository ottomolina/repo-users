package com.gsu.dao;

import java.sql.Connection;
import java.sql.SQLException;

import com.gsu.orm.GsuAddressOrm;

public class GsuAddressDao extends GeneralDao {
	
	public Long getNextId(Connection conn) throws SQLException {
		String sql = "select ifnull(max(GSU_ADR_ID), 0) + 1 ";
		sql = sql + " from " + GsuAddressOrm.TABLENAME;
		return getOneColumnRow(conn, sql, null, Long.class);
	}
	
	public boolean isDuplicate(Connection conn, GsuAddressOrm orm) throws SQLException {
		/**
		 * De momento no existe razon para realizar esta verificacion, queda
		 * codificada la estructura del metodo por si mas adelante es necesaria
		 */
		return false;
	}
	
	public Integer validIntegrity(Connection conn, GsuAddressOrm orm) throws SQLException {
		/**
		 * De momento no existe razon para realizar esta verificacion, queda
		 * codificada la estructura del metodo por si mas adelante es necesaria
		 */
		return 0;
	}
	
	public Integer insert(Connection conn, GsuAddressOrm orm) throws SQLException {
		String sql = "insert into " + GsuAddressOrm.TABLENAME + "(";
		sql = sql + "GSU_USR_ID, GSU_ADR_ID, GSU_ADR_ADDRESS, ";
		sql = sql + "GSU_ADR_TYPE, GSU_ADR_MAIN) ";
		sql = sql + "values(?, ?, ?, ?, ?)";
		Object[] params = {orm.getGsu_usr_id(), orm.getGsu_adr_id(), orm.getGsu_adr_address(), 
				orm.getGsu_adr_type(), orm.getGsu_adr_main()};
		return insert(conn, sql, params);
	}
	
}
